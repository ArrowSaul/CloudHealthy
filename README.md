# 云E养医疗平台后端系统架构说明

## 📌 项目概述
云E养医疗平台是基于Spring Boot+MyBatis+MySQL技术栈构建的智慧医疗解决方案，专注于为互联网医疗场景提供高效、安全的业务支撑。系统采用分层架构设计，整合了患者全生命周期管理、医疗资源调度、药品供应链管理等核心功能模块，支持日均10万级用户访问量，满足B2C医疗问诊、健康管理、医药电商等复合型业务场景需求。

---

## 🛠️ 技术选型
| 类别         | 技术组件                                                     |
| ------------ | ------------------------------------------------------------ |
| **核心框架** | Spring Boot 3.1.6（快速构建+自动配置）                       |
| **ORM框架**  | MyBatis-Plus 3.5.4（增强CRUD操作+动态SQL）                   |
| **数据库**   | MySQL 8.0（主从分离架构）+ Redis 7.0（缓存热点数据）         |
| **安全框架** | Spring Security 6.1.5（RBAC权限控制+JWT令牌）                |
| **辅助工具** | Lombok（代码简化）、Swagger 3.0（API文档）、Docker（容器化部署） |

---

## 🏗️ 核心功能模块

### 1. **用户中心服务**
- **功能**：  
  - 多端登录（短信/微信/OAuth2.0）  
  - 分级权限管理（患者/医生/药师/管理员）  
  - 患者健康档案数字化存储  
- **技术实现**：RBAC模型动态鉴权，MyBatis动态SQL实现多条件用户检索。

### 2. **医疗服务引擎**
- **核心流程**：  
  - 智能预约挂号（科室/医生时段匹配）  
  - 电子病历管理（PDF/影像文件存储）  
  - 在线问诊（WebSocket实时通信）  
- **创新点**：基于Redis GEO实现就近医院推荐，MyBatis结果集映射复杂病历结构。

### 3. **药品供应链管理**
- **功能亮点**：  
  - 药品库存动态预警（Redis原子操作）  
  - 进销存全链路追踪（MyBatis事务管理）  
  - 处方审核联动（药品禁忌智能校验）  
- **数据模型**：MySQL事务表记录药品流通轨迹，SPU/SKU分级存储。

### 4. **数据统计分析**
- **功能模块**：  
  - 就诊量热力地图（MySQL空间函数）  
  - 药品销售TOP榜（MyBatis聚合查询）  
  - 医生接诊效率分析  
- **技术方案**：定时任务+MyBatis动态报表生成。

---

## ⚙️ 系统架构
### 分层架构设计
1. **接入层**  
   - Spring Cloud Gateway实现API路由/限流  
2. **业务层**  
   - 微服务拆分：用户服务/问诊服务/药品服务独立部署  
3. **数据层**  
   - MySQL主从读写分离+MyBatis多数据源配置  
   - Redis集群缓存高频访问数据（医生排班/药品库存）  

### 高可用方案
- 数据库：GTID主从复制+半同步机制  
- 服务：Kubernetes Pod自动扩缩容  
- 监控：Prometheus+SkyWalking全链路追踪  

---

## ✨ 项目亮点
1. **医疗级数据安全**  
   - 字段级加密存储敏感信息（Spring Security AES加密）  
   - 操作日志全量审计（MyBatis插件拦截SQL）  

2. **高性能事务处理**  
   - 药品库存扣减采用Redis+Lua脚本  
   - 问诊排队使用Redis SortedSet实现  

3. **智能扩展能力**  
   - 自定义MyBatis TypeHandler处理医疗特殊数据类型  
   - 插件式架构支持第三方医保系统对接  

---

## 🚀 部署方案
```bash
# 容器化部署示例
docker run -d \
  -e SPRING_DATASOURCE_URL=jdbc:mysql://mysql-cluster:3306/med_cloud \
  -e REDIS_NODES="redis-node1:6379,redis-node2:6380" \
  -p 8080:8080 \
  med-cloud-backend:1.0.0
```
**运维监控**：  
- ELK收集MyBatis SQL执行日志  
- Grafana展示MySQL慢查询统计  